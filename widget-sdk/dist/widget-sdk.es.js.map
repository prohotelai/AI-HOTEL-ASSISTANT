{"version":3,"file":"widget-sdk.es.js","sources":["../src/utils.ts","../src/chatClient.ts","../src/events.ts","../src/i18n.ts","../src/voice.ts","../src/style.ts","../src/theme.ts","../src/widgetDom.ts","../src/index.ts"],"sourcesContent":["import { WidgetLanguage, WidgetMessage } from './types'\n\nexport function resolveElement(target?: HTMLElement | string): HTMLElement {\n  if (!target) {\n    const el = document.createElement('div')\n    document.body.appendChild(el)\n    return el\n  }\n\n  if (target instanceof HTMLElement) {\n    return target\n  }\n\n  const found = document.querySelector<HTMLElement>(target)\n  if (!found) {\n    const el = document.createElement('div')\n    document.body.appendChild(el)\n    return el\n  }\n  return found\n}\n\nexport function buildEndpointUrl(base: string, path: string) {\n  const normalizedBase = base.endsWith('/') ? base.slice(0, -1) : base\n  const normalizedPath = path.startsWith('/') ? path : `/${path}`\n  return `${normalizedBase}${normalizedPath}`\n}\n\nexport function randomId(prefix = 'msg') {\n  if (typeof crypto !== 'undefined' && typeof crypto.randomUUID === 'function') {\n    return crypto.randomUUID()\n  }\n  return `${prefix}-${Math.random().toString(36).slice(2, 11)}`\n}\n\nexport function toMessage(value: { id: string; role: 'user' | 'assistant'; content: string; createdAt: string }): WidgetMessage {\n  return {\n    id: value.id,\n    role: value.role,\n    content: value.content,\n    createdAt: new Date(value.createdAt),\n  }\n}\n\nexport function normalizeLanguage(language: string | undefined, fallback: WidgetLanguage): WidgetLanguage {\n  if (!language) return fallback\n  const normalized = language.toLowerCase()\n  if (normalized === 'en' || normalized === 'es' || normalized === 'fr') {\n    return normalized\n  }\n  return fallback\n}\n","import { WidgetMessage } from './types'\nimport { buildEndpointUrl, toMessage } from './utils'\n\ntype ChatClientConfig = {\n  apiBaseUrl: string\n  hotelId: string\n  conversationId?: string\n  guestId?: string\n  headers?: Record<string, string>\n  permissions?: string[]\n}\n\ntype ChatResponse = {\n  conversationId: string\n  messages: Array<{\n    id: string\n    role: 'user' | 'assistant'\n    content: string\n    createdAt: string\n  }>\n}\n\nexport function createChatClient(config: ChatClientConfig) {\n  async function sendMessage(content: string): Promise<{ messages: WidgetMessage[]; conversationId: string }> {\n    const endpoint = buildEndpointUrl(config.apiBaseUrl, '/api/chat')\n\n    const response = await fetch(endpoint, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        ...config.headers,\n      },\n      body: JSON.stringify({\n        hotelId: config.hotelId,\n        conversationId: config.conversationId,\n        guestId: config.guestId,\n        message: content,\n        permissions: config.permissions,\n      }),\n    })\n\n    if (!response.ok) {\n      const body = await response.text()\n      throw new Error(`Chat request failed: ${response.status} ${body}`)\n    }\n\n    const data = (await response.json()) as ChatResponse\n    config.conversationId = data.conversationId\n    const messages = data.messages.map(toMessage)\n    return { messages, conversationId: data.conversationId }\n  }\n\n  return { sendMessage }\n}\n","import { WidgetEvent, WidgetEventHandler, WidgetEventPayloads } from './types'\n\ntype HandlerMap = {\n  [K in WidgetEvent]?: Set<WidgetEventHandler<K>>\n}\n\nexport class WidgetEventBus {\n  private handlers: HandlerMap = {}\n\n  on<K extends WidgetEvent>(event: K, handler: WidgetEventHandler<K>): () => void {\n    const set = (this.handlers[event] ??= new Set()) as Set<WidgetEventHandler<K>>\n    set.add(handler)\n    return () => this.off(event, handler)\n  }\n\n  off<K extends WidgetEvent>(event: K, handler: WidgetEventHandler<K>) {\n    const set = this.handlers[event] as Set<WidgetEventHandler<K>> | undefined\n    set?.delete(handler)\n  }\n\n  emit<K extends WidgetEvent>(event: K, payload: WidgetEventPayloads[K]) {\n    const set = this.handlers[event] as Set<WidgetEventHandler<K>> | undefined\n    set?.forEach((handler) => handler(payload))\n    const globalEvent = new CustomEvent(`prohotelai:${event}`, { detail: payload })\n    window.dispatchEvent(globalEvent)\n  }\n}\n","import { WidgetLanguage, WidgetTranslations } from './types'\n\nconst DEFAULT_DICTIONARY: Record<WidgetLanguage, Record<string, string>> = {\n  en: {\n    'widget.title': 'Need help? Chat with us',\n    'widget.input.placeholder': 'Ask a question…',\n    'widget.send': 'Send',\n    'widget.voice.start': 'Start voice',\n    'widget.voice.stop': 'Stop voice',\n    'widget.aria.open': 'Open AI assistant chat',\n    'widget.aria.close': 'Close AI assistant chat',\n    'widget.status.offline': 'Assistant is unavailable. Try again later.',\n  },\n  es: {\n    'widget.title': '¿Necesitas ayuda? Chatea con nosotros',\n    'widget.input.placeholder': 'Haz una pregunta…',\n    'widget.send': 'Enviar',\n    'widget.voice.start': 'Iniciar voz',\n    'widget.voice.stop': 'Detener voz',\n    'widget.aria.open': 'Abrir chat del asistente de IA',\n    'widget.aria.close': 'Cerrar chat del asistente de IA',\n    'widget.status.offline': 'El asistente no está disponible. Inténtalo más tarde.',\n  },\n  fr: {\n    'widget.title': 'Besoin d’aide ? Discutez avec nous',\n    'widget.input.placeholder': 'Posez une question…',\n    'widget.send': 'Envoyer',\n    'widget.voice.start': 'Activer la voix',\n    'widget.voice.stop': 'Arrêter la voix',\n    'widget.aria.open': 'Ouvrir le chat de l’assistant IA',\n    'widget.aria.close': 'Fermer le chat de l’assistant IA',\n    'widget.status.offline': 'Assistant indisponible. Réessayez plus tard.',\n  },\n}\n\nexport function createTranslator(language: WidgetLanguage, overrides?: WidgetTranslations) {\n  let currentLanguage = language\n  const dictionaries: Record<WidgetLanguage, Record<string, string>> = {\n    en: { ...DEFAULT_DICTIONARY.en },\n    es: { ...DEFAULT_DICTIONARY.es },\n    fr: { ...DEFAULT_DICTIONARY.fr },\n  }\n\n  if (overrides) {\n    Object.entries(overrides).forEach(([lang, values]) => {\n      if (!values) return\n      const normalized = lang as WidgetLanguage\n      const existing = dictionaries[normalized] ?? {}\n      dictionaries[normalized] = { ...existing, ...values }\n    })\n  }\n\n  function t(key: string) {\n    const dict = dictionaries[currentLanguage]\n    return dict?.[key] ?? DEFAULT_DICTIONARY.en[key] ?? key\n  }\n\n  function setLanguage(lang: WidgetLanguage) {\n    currentLanguage = lang\n  }\n\n  return { t, setLanguage }\n}\n","import { WidgetEventBus } from './events'\n\ntype VoiceControllerOptions = {\n  eventBus: WidgetEventBus\n  onText: (text: string) => void\n}\n\ntype SpeechRecognitionConstructor = new () => SpeechRecognition\n\ndeclare global {\n  interface Window {\n    webkitSpeechRecognition?: SpeechRecognitionConstructor\n  }\n}\n\nexport function createVoiceController(options: VoiceControllerOptions) {\n  const SpeechRecognition = (window.SpeechRecognition ?? window.webkitSpeechRecognition) as\n    | SpeechRecognitionConstructor\n    | undefined\n\n  let recognition: SpeechRecognition | null = null\n\n  function supportsRecognition() {\n    return Boolean(SpeechRecognition)\n  }\n\n  function startRecognition() {\n    if (!SpeechRecognition) {\n      options.eventBus.emit('error', { message: 'Speech recognition not supported' })\n      return\n    }\n\n    if (recognition) {\n      recognition.stop()\n    }\n\n    recognition = new SpeechRecognition()\n    recognition.lang = navigator.language || 'en-US'\n    recognition.interimResults = false\n    recognition.onresult = (event) => {\n      const transcript = event.results?.[0]?.[0]?.transcript\n      if (transcript) {\n        options.onText(transcript)\n      }\n    }\n    recognition.onerror = (event) => {\n      options.eventBus.emit('error', { message: 'Speech recognition error', error: event.error })\n    }\n\n    recognition.start()\n    options.eventBus.emit('voice:start', undefined)\n  }\n\n  function stopRecognition() {\n    recognition?.stop()\n    recognition = null\n    options.eventBus.emit('voice:stop', undefined)\n  }\n\n  function speak(text: string) {\n    if (!('speechSynthesis' in window)) {\n      return\n    }\n    const utterance = new SpeechSynthesisUtterance(text)\n    utterance.lang = navigator.language || 'en-US'\n    window.speechSynthesis.cancel()\n    window.speechSynthesis.speak(utterance)\n  }\n\n  return {\n    supportsRecognition,\n    startRecognition,\n    stopRecognition,\n    speak,\n  }\n}\n","export function injectStyles(root: ShadowRoot | Document) {\n  const existing = root.querySelector('#prohotelai-widget-styles')\n  if (existing) return\n\n  const style = document.createElement('style')\n  style.id = 'prohotelai-widget-styles'\n  style.textContent = `\n    :host, .prohotelai-widget {\n      all: initial;\n      font-family: var(--prohotelai-font-family);\n      color: var(--prohotelai-text);\n    }\n\n    .prohotelai-toggle {\n      position: fixed;\n      bottom: 24px;\n      right: 24px;\n      background: var(--prohotelai-accent);\n      color: #fff;\n      border: none;\n      border-radius: 999px;\n      padding: 12px 16px;\n      cursor: pointer;\n      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);\n      font-size: 14px;\n    }\n\n    .prohotelai-window {\n      position: fixed;\n      bottom: 90px;\n      right: 24px;\n      width: min(360px, calc(100vw - 32px));\n      max-height: 520px;\n      background: var(--prohotelai-background);\n      color: var(--prohotelai-text);\n      border-radius: var(--prohotelai-radius);\n      box-shadow: 0 24px 48px rgba(15, 23, 42, 0.35);\n      display: flex;\n      flex-direction: column;\n      overflow: hidden;\n      opacity: 0;\n      pointer-events: none;\n      transform: translateY(16px);\n      transition: opacity 0.2s ease, transform 0.2s ease;\n    }\n\n    .prohotelai-window.open {\n      opacity: 1;\n      pointer-events: auto;\n      transform: translateY(0);\n    }\n\n    .prohotelai-header {\n      padding: 16px;\n      font-weight: 600;\n      font-size: 16px;\n      border-bottom: 1px solid rgba(148, 163, 184, 0.2);\n    }\n\n    .prohotelai-messages {\n      flex: 1;\n      overflow-y: auto;\n      padding: 16px;\n      display: flex;\n      flex-direction: column;\n      gap: 12px;\n      scroll-behavior: smooth;\n    }\n\n    .prohotelai-message {\n      padding: 12px 14px;\n      border-radius: 12px;\n      font-size: 14px;\n      line-height: 1.4;\n      white-space: pre-wrap;\n      background: rgba(15, 23, 42, 0.45);\n    }\n\n    .prohotelai-message.user {\n      align-self: flex-end;\n      background: rgba(37, 99, 235, 0.9);\n      color: #fff;\n    }\n\n    .prohotelai-message.assistant {\n      align-self: flex-start;\n      background: rgba(15, 23, 42, 0.65);\n    }\n\n    .prohotelai-form {\n      display: flex;\n      gap: 8px;\n      padding: 12px 16px 16px 16px;\n      border-top: 1px solid rgba(148, 163, 184, 0.2);\n    }\n\n    .prohotelai-input {\n      flex: 1;\n      border: 1px solid rgba(148, 163, 184, 0.4);\n      border-radius: 12px;\n      padding: 10px 12px;\n      font-size: 14px;\n      color: var(--prohotelai-text);\n      background: rgba(15, 23, 42, 0.85);\n    }\n\n    .prohotelai-input::placeholder {\n      color: rgba(226, 232, 240, 0.6);\n    }\n\n    .prohotelai-send {\n      background: var(--prohotelai-accent);\n      color: #fff;\n      border: none;\n      border-radius: 12px;\n      padding: 0 16px;\n      font-size: 14px;\n      cursor: pointer;\n      transition: transform 0.1s ease;\n    }\n\n    .prohotelai-send:active {\n      transform: scale(0.97);\n    }\n\n    .prohotelai-voice {\n      margin-left: 4px;\n      background: transparent;\n      border: 1px solid rgba(148, 163, 184, 0.4);\n      color: var(--prohotelai-text);\n      border-radius: 12px;\n      padding: 0 12px;\n      cursor: pointer;\n      font-size: 13px;\n    }\n\n    .prohotelai-status {\n      font-size: 12px;\n      color: rgba(226, 232, 240, 0.6);\n      padding: 0 16px 12px 16px;\n    }\n  `\n\n  root.appendChild(style)\n}\n","import { WidgetTheme } from './types'\n\nconst DEFAULT_THEME: Required<WidgetTheme> = {\n  accentColor: '#2563eb',\n  backgroundColor: '#0f172a',\n  textColor: '#f8fafc',\n  borderRadius: '16px',\n  fontFamily: '\"Inter\", system-ui, -apple-system, BlinkMacSystemFont, \"Segoe UI\", sans-serif',\n}\n\nexport function applyTheme(element: HTMLElement, theme?: WidgetTheme) {\n  const merged = { ...DEFAULT_THEME, ...(theme ?? {}) }\n  element.style.setProperty('--prohotelai-accent', merged.accentColor)\n  element.style.setProperty('--prohotelai-background', merged.backgroundColor)\n  element.style.setProperty('--prohotelai-text', merged.textColor)\n  element.style.setProperty('--prohotelai-radius', merged.borderRadius)\n  element.style.setProperty('--prohotelai-font-family', merged.fontFamily)\n}\n","import { WidgetEventBus } from './events'\nimport { injectStyles } from './style'\nimport { applyTheme } from './theme'\nimport { WidgetMessage, WidgetPermissions } from './types'\n\nexport type WidgetDomOptions = {\n  mountPoint: HTMLElement\n  eventBus: WidgetEventBus\n  t: (key: string) => string\n  onSend: (message: string) => void\n  onToggle: () => void\n  onStartVoice: () => void\n  onStopVoice: () => void\n  onRequestTicket: () => void\n  permissions?: WidgetPermissions\n  enableVoice: boolean\n}\n\nexport type WidgetDom = {\n  open: () => void\n  close: () => void\n  toggle: () => void\n  renderMessages: (messages: WidgetMessage[]) => void\n  setLanguage: (t: (key: string) => string) => void\n  setVoiceAvailable: (available: boolean) => void\n  destroy: () => void\n  setStatus: (status: string | null) => void\n}\n\nexport function createWidgetDom(options: WidgetDomOptions): WidgetDom {\n  const container = document.createElement('div')\n  container.className = 'prohotelai-widget'\n  applyTheme(container)\n  injectStyles(document)\n\n  const toggleButton = document.createElement('button')\n  toggleButton.className = 'prohotelai-toggle'\n  toggleButton.type = 'button'\n  toggleButton.setAttribute('aria-label', options.t('widget.aria.open'))\n  toggleButton.textContent = 'AI Assistant'\n  toggleButton.addEventListener('click', options.onToggle)\n\n  const windowEl = document.createElement('div')\n  windowEl.className = 'prohotelai-window'\n\n  const header = document.createElement('div')\n  header.className = 'prohotelai-header'\n  header.textContent = options.t('widget.title')\n\n  const messagesEl = document.createElement('div')\n  messagesEl.className = 'prohotelai-messages'\n\n  const statusEl = document.createElement('div')\n  statusEl.className = 'prohotelai-status'\n  statusEl.style.display = 'none'\n\n  const form = document.createElement('form')\n  form.className = 'prohotelai-form'\n\n  const input = document.createElement('input')\n  input.className = 'prohotelai-input'\n  input.type = 'text'\n  input.placeholder = options.t('widget.input.placeholder')\n  input.autocomplete = 'off'\n  input.setAttribute('aria-label', options.t('widget.input.placeholder'))\n\n  const sendButton = document.createElement('button')\n  sendButton.className = 'prohotelai-send'\n  sendButton.type = 'submit'\n  sendButton.textContent = options.t('widget.send')\n\n  const voiceButton = document.createElement('button')\n  voiceButton.className = 'prohotelai-voice'\n  voiceButton.type = 'button'\n  voiceButton.textContent = options.t('widget.voice.start')\n  voiceButton.style.display = options.enableVoice ? 'inline-flex' : 'none'\n\n  let voiceActive = false\n\n  voiceButton.addEventListener('click', () => {\n    if (!voiceActive) {\n      options.onStartVoice()\n      voiceActive = true\n      voiceButton.textContent = options.t('widget.voice.stop')\n    } else {\n      options.onStopVoice()\n      voiceActive = false\n      voiceButton.textContent = options.t('widget.voice.start')\n    }\n  })\n\n  form.addEventListener('submit', (event) => {\n    event.preventDefault()\n    const value = input.value.trim()\n    if (value.length === 0) return\n    options.onSend(value)\n    input.value = ''\n    voiceActive = false\n    voiceButton.textContent = options.t('widget.voice.start')\n  })\n\n  const ticketButton = document.createElement('button')\n  ticketButton.type = 'button'\n  ticketButton.textContent = 'Create ticket'\n  ticketButton.className = 'prohotelai-voice'\n  ticketButton.style.display = options.permissions?.includes('tickets:create') ? 'inline-flex' : 'none'\n  ticketButton.addEventListener('click', () => {\n    options.onRequestTicket()\n  })\n\n  form.appendChild(input)\n  form.appendChild(sendButton)\n  form.appendChild(voiceButton)\n  form.appendChild(ticketButton)\n\n  windowEl.appendChild(header)\n  windowEl.appendChild(messagesEl)\n  windowEl.appendChild(statusEl)\n  windowEl.appendChild(form)\n\n  container.appendChild(toggleButton)\n  container.appendChild(windowEl)\n\n  options.mountPoint.appendChild(container)\n\n  function renderMessages(messages: WidgetMessage[]) {\n    messagesEl.innerHTML = ''\n    messages.forEach((message) => {\n      const bubble = document.createElement('div')\n      bubble.className = `prohotelai-message ${message.role}`\n      bubble.textContent = message.content\n      messagesEl.appendChild(bubble)\n    })\n    messagesEl.scrollTop = messagesEl.scrollHeight\n  }\n\n  function open() {\n    windowEl.classList.add('open')\n    toggleButton.setAttribute('aria-label', options.t('widget.aria.close'))\n  }\n\n  function close() {\n    windowEl.classList.remove('open')\n    toggleButton.setAttribute('aria-label', options.t('widget.aria.open'))\n  }\n\n  function toggle() {\n    if (windowEl.classList.contains('open')) {\n      close()\n    } else {\n      open()\n    }\n  }\n\n  function setLanguage(t: (key: string) => string) {\n    header.textContent = t('widget.title')\n    input.placeholder = t('widget.input.placeholder')\n    input.setAttribute('aria-label', t('widget.input.placeholder'))\n    sendButton.textContent = t('widget.send')\n    voiceButton.textContent = voiceActive ? t('widget.voice.stop') : t('widget.voice.start')\n    toggleButton.setAttribute('aria-label', windowEl.classList.contains('open') ? t('widget.aria.close') : t('widget.aria.open'))\n  }\n\n  function setVoiceAvailable(available: boolean) {\n    voiceButton.style.display = available ? 'inline-flex' : 'none'\n  }\n\n  function setStatus(status: string | null) {\n    if (!status) {\n      statusEl.style.display = 'none'\n      statusEl.textContent = ''\n    } else {\n      statusEl.style.display = 'block'\n      statusEl.textContent = status\n    }\n  }\n\n  function destroy() {\n    container.remove()\n  }\n\n  return {\n    open,\n    close,\n    toggle,\n    renderMessages,\n    setLanguage,\n    setVoiceAvailable,\n    destroy,\n    setStatus,\n  }\n}\n","import { createChatClient } from './chatClient'\nimport { WidgetEventBus } from './events'\nimport { createTranslator } from './i18n'\nimport { createVoiceController } from './voice'\nimport { createWidgetDom } from './widgetDom'\nimport { normalizeLanguage, randomId, resolveElement } from './utils'\nimport { applyTheme } from './theme'\nimport {\n  WidgetConfig,\n  WidgetController,\n  WidgetEvent,\n  WidgetEventHandler,\n  WidgetLanguage,\n  WidgetMessage,\n  WidgetPermissions,\n} from './types'\n\nexport type {\n  WidgetConfig,\n  WidgetController,\n  WidgetLanguage,\n  WidgetMessage,\n  WidgetPermissions,\n  WidgetEvent,\n  WidgetEventHandler,\n}\n\nconst DEFAULT_LANGUAGE: WidgetLanguage = 'en'\n\nexport function createWidget(config: WidgetConfig): WidgetController {\n  const mountPoint = resolveElement(config.element)\n  const language = normalizeLanguage(config.defaultLanguage, DEFAULT_LANGUAGE)\n  const eventBus = new WidgetEventBus()\n  const translator = createTranslator(language, config.translations)\n  const chatClient = createChatClient({\n    apiBaseUrl: config.apiBaseUrl,\n    hotelId: config.hotelId,\n    conversationId: config.conversationId,\n    guestId: config.guestId,\n    headers: config.headers,\n    permissions: config.permissions,\n  })\n\n  const voice = createVoiceController({\n    eventBus,\n    onText: (text) => {\n      void sendMessage(text)\n    },\n  })\n\n  const dom = createWidgetDom({\n    mountPoint,\n    eventBus,\n    t: translator.t,\n    onSend: (message) => {\n      void sendMessage(message)\n    },\n    onToggle: () => {\n      dom.toggle()\n    },\n    onStartVoice: () => {\n      voice.startRecognition()\n    },\n    onStopVoice: () => {\n      voice.stopRecognition()\n    },\n    onRequestTicket: () => {\n      void sendMessage('Please create a ticket for this request.')\n    },\n    permissions: config.permissions,\n    enableVoice: Boolean(config.enableVoice),\n  })\n\n  applyTheme(mountPoint, config.theme)\n\n  let messages: WidgetMessage[] = []\n\n  async function sendMessage(content: string) {\n    const tempId = randomId('local')\n    const optimisticMessage: WidgetMessage = {\n      id: tempId,\n      role: 'user',\n      content,\n      createdAt: new Date(),\n    }\n    messages = [...messages, optimisticMessage]\n    dom.renderMessages(messages)\n    eventBus.emit('message:sent', { id: optimisticMessage.id, content: optimisticMessage.content })\n\n    try {\n      const { messages: responseMessages } = await chatClient.sendMessage(content)\n      messages = responseMessages\n      dom.renderMessages(messages)\n      const latest = responseMessages.at(-1)\n      if (latest && latest.role === 'assistant') {\n        eventBus.emit('message:received', { id: latest.id, content: latest.content })\n        if (config.enableVoice) {\n          voice.speak(latest.content)\n        }\n      }\n      dom.setStatus(null)\n    } catch (error) {\n      eventBus.emit('error', { message: 'Failed to send message', error })\n      dom.setStatus(translator.t('widget.status.offline'))\n    }\n  }\n\n  function setLanguage(next: WidgetLanguage) {\n    translator.setLanguage(next)\n    dom.setLanguage(translator.t)\n  }\n\n  function setTheme(theme: Parameters<typeof applyTheme>[1]) {\n    applyTheme(mountPoint, theme)\n  }\n\n  const controller: WidgetController = {\n    open: dom.open,\n    close: dom.close,\n    toggle: dom.toggle,\n    sendMessage,\n    setLanguage,\n    setTheme,\n    startVoice: () => {\n      if (!config.enableVoice) return\n      voice.startRecognition()\n    },\n    stopVoice: () => {\n      voice.stopRecognition()\n    },\n    destroy: () => {\n      dom.destroy()\n    },\n    on: (event, handler) => eventBus.on(event, handler),\n  }\n\n  dom.setVoiceAvailable(config.enableVoice ? voice.supportsRecognition() : false)\n\n  eventBus.emit('ready', { mountedAt: Date.now() })\n\n  return controller\n}\n\nif (typeof window !== 'undefined') {\n  ;(window as typeof window & { ProHotelAIWidget?: { createWidget: typeof createWidget } }).ProHotelAIWidget = {\n    createWidget,\n  }\n}\n"],"names":["resolveElement","target","el","found","buildEndpointUrl","base","path","normalizedBase","normalizedPath","randomId","prefix","toMessage","value","normalizeLanguage","language","fallback","normalized","createChatClient","config","sendMessage","content","endpoint","response","body","data","WidgetEventBus","event","handler","_a","set","payload","globalEvent","DEFAULT_DICTIONARY","createTranslator","overrides","currentLanguage","dictionaries","lang","values","existing","t","key","dict","setLanguage","createVoiceController","options","SpeechRecognition","recognition","supportsRecognition","startRecognition","_b","_c","transcript","stopRecognition","speak","text","utterance","injectStyles","root","style","DEFAULT_THEME","applyTheme","element","theme","merged","createWidgetDom","container","toggleButton","windowEl","header","messagesEl","statusEl","form","input","sendButton","voiceButton","voiceActive","ticketButton","renderMessages","messages","message","bubble","open","close","toggle","setVoiceAvailable","available","setStatus","status","destroy","DEFAULT_LANGUAGE","createWidget","mountPoint","eventBus","translator","chatClient","voice","dom","optimisticMessage","responseMessages","latest","error","next","setTheme","controller"],"mappings":"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"}